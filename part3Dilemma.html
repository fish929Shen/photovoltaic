<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>困境</title>
    <style>
        /* 补充CSS样式确保内容区域可正确定位
        在现有样式中添加 */
        #part4-container {
            scroll-margin-top: 80px;
            /* 根据顶部导航栏高度调整 */
        }

        /* 导航图标激活状态样式 */
        .nav-icon.active {
            background-color: #007bff;
            color: white;
            transform: scale(1.1);
        }

        /* 武器图标（盾图案）样式 */
        .weapon-icon {
            position: relative;
            display: inline-block;
            cursor: pointer;
        }

        .weapon-tooltip {
            visibility: hidden;
            position: absolute;
            top: -10px;
            right: 100%;
            width: 250px;
            background-color: #333;
            color: white;
            padding: 8px;
            border-radius: 4px;
            z-index: 100;
            font-size: 14px;
        }

        .weapon-icon:hover .weapon-tooltip {
            visibility: visible;
        }

        /* 内容区域图片+文字布局样式 */
        .hegemony-content {
            display: flex;
            align-items: center;
            gap: 20px;
            padding: 20px;
        }

        .hegemony-text {
            flex: 1;
        }

        .hegemony-image img {
            max-width: 400px;
            border-radius: 8px;
        }

        .content-text {
            line-height: 1.6;
            font-size: 16px;
        }









        body {
            height: auto;
            width: 100%;
            position: relative;
            /* 为背景网格添加定位上下文 */
            overflow-x: hidden;
        }

        /* 背景网格容器 */
        .grid-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            /* 确保在内容下方 */
            pointer-events: none;
            /* 允许鼠标穿透到下方内容 */
        }

        /* 网格单元格样式 */
        .grid-cell {
            position: absolute;
            width: 40px;
            height: 40px;
            box-sizing: border-box;
            border: 1px solid rgba(5, 217, 232, 0.1);
            transition: border-color 0.3s ease;
        }

        /* 激活状态的网格单元格 */
        .grid-cell.active {
            border-color: rgba(5, 217, 232, 0.5);
            animation: fadeOut 1s forwards;
        }

        /* 淡出动画 */
        @keyframes fadeOut {
            to {
                border-color: rgba(5, 217, 232, 0.1);
            }
        }


        /* 这是一个没招了的转场按钮 */
        /* 按钮样式 */
        .next-chapter-btn {
            display: inline-block;
            width: 100px;
            height: 50px;
            border-radius: 10%;
            background-color: #2b9797c5;
            color: white;
            text-align: center;
            line-height: 50px;
            text-decoration: none;
            font-family: sans-serif;
            transition: all 0.3s ease;
        }

        /* 悬停效果 */
        .next-chapter-btn:hover {
            background-color: #2b9797;
            transform: scale(1.05);
        }
    </style>
    <link rel="stylesheet" href="./css/part1_fix_and_intro.css">
    <link rel="stylesheet" href="./css/index3.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>

<body>
    <!-- 背景网格 -->
    <div class="grid-background" id="gridBackground"></div>

    <!-- 顶部生存条 -->
    <div class="status-bar">
        <!-- 头像 -->
        <div class="player-avatar">
            <img src="./img/part1-intro.png" alt="赛博朋克风格的游戏角色头像" class="avatar-image">
        </div>

        <!-- 生存条 -->
        <div class="status-bars">
            <div class="status-item health">
                <span class="status-label">生命</span>
                <div class="status-bar-container">
                    <div class="status-fill" style="width: 70%;"></div>
                </div>
            </div>

            <div class="status-item energy">
                <span class="status-label">能量</span>
                <div class="status-bar-container">
                    <div class="status-fill" style="width: 70%;"></div>
                </div>
            </div>

            <div class="status-item reputation">
                <span class="status-label">声望</span>
                <div class="status-bar-container">
                    <div class="status-fill" style="width: 80%;"></div>

                </div>
            </div>
        </div>

        <!-- 新增的两头粗中间细的线图案 -->
        <div class="cyber-line">
            <div class="cyber-line-inner"></div>
        </div>
    </div>

    <!-- 左侧导航栏 -->
    <div class="side-nav">
        <div class="side-nav-item " data-nav="启航">
            <span><a href="part1Embarkation.html">启航</a></span>
        </div>
        <div class="side-nav-item" data-nav="曙光">
            <span><a href="part2Dawn.html">曙光</a></span>
        </div>
        <div class="side-nav-item active" data-nav="困境">
            <span>困境</span>
        </div>
        <div class="side-nav-item" data-nav="突围">

            <span><a href="part4Breakthrough.html">突围</a></span>
        </div>
        <div class="bottom-line"></div> <!-- 竖线底部加粗 -->
    </div>
    <!-- 底部滚动提示 -->
    <div class="scroll-indicator">
        <div class="scroll-text">向下滑动</div>
        <div class="scroll-arrow"></div>
    </div>
    <!-- 白场过渡 -->
    <div class="loading"> </div>
    <!-- 正文 -->
    <div class="content">
        <!-- 头页 -->
        <div class="head">
            <img src="./img/3.png" alt="困境">
        </div>
        <!-- 开头的文字引入 -->
        <div class="alert-container">
            <!-- 顶部黄黑警报线 -->
            <div class="alert-line top"></div>

            <div class="content-wrapper">
                <div>
                    <span class="exclamation"><i class="fas fa-exclamation-triangle"></i></span>
                    <h1 class="alert-title flicker">警报！</h1>
                </div>

                <p class="alert-message">探索者光晟，前沿基地遭遇未知故障！</p>

                <button class="alert-btn"
                    onclick="document.getElementById('part4-container').scrollIntoView({behavior: 'smooth'})">点击介入，力挽狂澜!</button>
            </div>

            <!-- 底部黄黑警报线 -->
            <div class="alert-line bottom"></div>


        </div>

        <!-- BOSS卡片 -->
        <div class="cyber-effect">
            <div class="grid-lines"></div>
            <div class="particles" id="particles"></div>
        </div>

        <div class="container" id="part4-container">
            <!-- 导航栏 -->
            <div class="nav-bar">
                <div class="nav-icon active" data-section="misunderstanding">
                    <i class="fas fa-question"></i>
                </div>
                <div class="nav-icon" data-section="abandoned-power">
                    <i class="fas fa-bolt"></i>
                </div>
                <div class="nav-icon" data-section="industry">
                    <i class="fas fa-industry"></i>
                </div>
                <div class="nav-icon" data-section="hegemony">
                    <i class="fas fa-shield-alt"></i>
                </div>
                <!-- 添加第5个导航图标 -->
                <div class="nav-icon" data-section="compete">
                    <i class="fa-solid fa-earth-americas"></i>
                </div>
            </div>

            <!-- 主内容区 -->
            <div class="main-content" style="height: auto;">
                <!-- 顶部区域 -->
                <div class="top-section">
                    <div class="info-panel">
                        <div class="difficulty">
                            <span class="difficulty-label">难度系数：</span>
                            <span class="star">★</span>
                            <span class="star">★</span>
                            <span class="star">☆</span>
                            <span class="star">☆</span>
                            <span class="star">☆</span>
                        </div>
                        <h1 class="title">认知壁垒：从误解到接纳的距离</h1>
                    </div>
                    <div class="weapon-panel">
                        <div class="weapon-icon">
                            <i class="fas fa-shield-alt"></i>
                        </div>
                        <div class="weapon-tooltip">
                            光伏扶贫政策让河北阜平的贫困户屋顶变成"阳光存折"，每户年均增收3000元。
                        </div>
                    </div>
                </div>

                <!-- 内容区域 -->
                <div class="content-section">
                    <p class="content-text">
                        在光伏产业发展的初期，公众对这项技术的认知存在诸多误解。许多人认为光伏发电效率低下、成本高昂，难以大规模应用。然而，随着技术进步和政策支持，光伏发电的成本已从2010年的每瓦30元降至2023年的每瓦1.5元，降幅达95%。效率方面，主流光伏组件的转换效率从15%提升至23%，叠层电池实验室效率更是突破33%。这些数据有力驳斥了早期的认知误区。
                    </p>
                </div>
            </div>
            <!-- 导航箭头 -->
            <div class="nav-arrow up">
                <p>上一个</p>
                <i class="fas fa-chevron-up"></i>
            </div>
            <div class="nav-arrow down">
                <p>下一个</p>
                <i class="fas fa-chevron-down"></i>
            </div>
        </div>



        <div>
            <div style="height: 30vh;display: flex;justify-content: center;align-items: center;">
                <a href="./part4Breakthrough.html" class="next-chapter-btn">下一章</a>
            </div>
        </div>
    </div>


    </div>

    <script>
        // 文字和图片动画效果
        document.addEventListener('DOMContentLoaded', function () {
            // ===== 状态条控制相关代码 =====
            // 获取状态条元素
            const healthFill = document.querySelector('.health .status-fill');
            const energyFill = document.querySelector('.energy .status-fill');
            const reputationFill = document.querySelector('.reputation .status-fill');

            // 保存原始宽度值（从HTML中获取初始设置）
            const originalWidths = {
                health: parseInt(healthFill.style.width),
                energy: parseInt(energyFill.style.width),
                reputation: parseInt(reputationFill.style.width)
            };

            // 目标宽度（30%）
            const targetWidth = 30;

            // ===== 卡片与导航相关代码 =====
            // 创建粒子效果
            createParticles();

            // 定义所有卡片数据
            const cards = [
                {
                    id: "misunderstanding",
                    title: "认知壁垒：<br> 从误解到接纳的距离",
                    difficulty: 2,
                    weaponIcon: "fas fa-shield-alt",
                    weaponTooltip: "光伏扶贫政策让河北阜平的贫困户屋顶变成'阳光存折'，每户年均增收3000元。",
                    content: {
                        type: "iframe",  // 修改类型为iframe
                        src: "./part4-danmu.html",  // 指定iframe源文件
                        text: "中国某些农村地区流传着“光伏致癌”的小道消息；原本的戈壁和盐碱滩却被造谣为'光伏致寸草不生'的荒地......看似荒唐的指控，源于人们对未知的光伏的恐惧。怎样打破光伏认知壁垒，让更多的人接纳，这是全球面临的共同课题。"
                    }
                },
                {
                    id: "abandoned-power",
                    title: "弃电难题：<br> 富光与用电的“时空错配”",
                    difficulty: 3,
                    weaponIcon: "fas fa-project-diagram",
                    weaponTooltip: "2022年'源网荷储'一体化政策推动光伏与储能绑定，西藏那曲的光伏电站通过配套储能，弃电率从31.4%降至15%。2022年《'十四五'新型储能发展实施方案》鼓励光伏项目配套储能，提出'源网荷储'一体化发展，支持分布式光伏与储能结合。新型储能参与电力辅助服务市场，提升电网调节能力。",
                    content: {
                        type: "text-image",
                        text: "中国光伏产业高速扩张的背后，资源禀赋与用电需求的严重错配正形成巨大瓶颈。光照充沛地区发电过剩却因本地需求不足、外送通道匮乏、储能推高综合成本等原因，陷入“电发得出，送不走，存不起”的困局，部分项目甚至陷入“越建越亏”的怪圈。  <br><br> 解决电发得多、用得少或送不出去的问题主要有两个办法，不过都存在困难：通过建特高压线路把电送出去，但每公里造价超1亿元，建设周期5年。而用锂电池把多余的电存起来，存一度电的成本在0.11-0.38元，光伏电的综合成本就涨了30%，但现在的电价机制还不能完全覆盖这些额外成本。",
                        image: "./img/part4-nav2.png"
                    }
                },
                {
                    id: "industry",
                    title: "无效“内卷”：<br>无序扩张陷内耗泥潭",
                    difficulty: 3,
                    weaponIcon: "fas fa-shield-alt",
                    weaponTooltip: "2025年《新能源上网电价市场化改革》推开'多退少补'机制，企业收益预期从'看补贴脸色'转向'靠市场说话'。",
                    content: {
                        type: "split",
                        left: "2021年'双碳'政策启动，光伏行业迎来爆发式增长。'五大六小'集团竞逐新能源项目，带动产业链投资热潮，吸引跨界资本涌入，巨头竞相扩张。<br><br>然而，非理性竞争引发市场结构性产能过剩，行业“内卷”严重，繁荣表象下危机四伏。光伏产能扩张远超全球需求，头部企业亏损出货。低端同质化产品充斥市场，叠加地方政府的扭曲激励，将“光伏项目与税收、产业指标捆绑，进一步加剧区域产能失衡，光伏竞赛从技术突破沦为规模消耗战。\n",
                        right: "./part4-nav3.html"
                    }
                },
                {
                    id: "hegemony",
                    title: "霸权围剿：<br>美国筑墙阻挠全球绿色发展",
                    difficulty: 5,
                    weaponIcon: "fas fa-shield-alt",
                    weaponTooltip: "商务部联合东南亚国家搭建'绿色贸易走廊'，2024年中国光伏组件经东南亚转口的占比提升至40%，绕开贸易壁垒的同时，带动当地光伏产业链升级。",
                    content: {
                        type: "image-text",
                        background: "./img/part4-nav4.png",
                        left: "在光伏出海路途中，光晟一行人遇到了争夺光伏的劲敌——美国。\n\n       对中国光伏产业的全球领先优势，美国频频发难，严重损害世界绿色转型和能源合作的未来。\n\n早在2012年，美国和欧盟就对中国光伏企业展开“双反”调查。无锡尚德、天合光能被征收超过30%的反倾销税，未应诉中国光伏企业的税率高达249.96%。\n\n近年来，美国更是大肆污名中国光伏“政府补贴导致产能过剩”和“低价倾销扭曲市场”。但根据国际能源署（IEA）明确预测，2030年，全球光伏新增装机需求将达到8.2亿千瓦，约是2022年的4倍，光伏等优质产能实则供不应求，存在巨大市场空间。\n\n 美国无视这一事实，继续滥用“双反”调查，甚至在2025年4月，祭出3500%的天价关税大棒，遏制中国在新能源领域的崛起。\n\n 美国所谓的“产业过剩论”，以贸易保护之名，行打压中国新能源产业之实。企图将中国锁定在价值链低端，为自身的产业落后筑起“护城河”。这种做法，不仅阻碍全球绿色转型进程，更违背了“能源危机需要全球协作”的基本共识，暴露其将地缘政治私利凌驾于人类共同福祉之上的短视。",
                        right: "./img/part4-nav4-2.png"
                    }
                },
                {
                    id: "compete",
                    title: "多元化能源竞争局势",
                    difficulty: 5,
                    weaponIcon: "fas fa-shield-alt",
                    weaponTooltip: "光伏行业应进一步优化制造工艺，研发更高效的电池技术，完善锂电池等配套储能系统，切实提高光伏发电竞争力。同时，推动清洁能源融合发展。在埃及大力推行“光伏+绿氢”双轮驱动时，我国新疆库车绿氢示范项目也采用了光伏发电直接制氢技术，年产绿氢2万吨。国家大力推行的“水风光互补”更是在助力低碳减排事业中发挥着关键作用。",
                    content: {
                        type: "text-image",
                        text: "2025年新年第一天，中国第三代核电技术建设的一台核电机组投入运行，预计每台机组每年发电可超100亿度。在经历长期停滞后，核电强势回归，正以超预期速度重启扩张。随着“双碳”目标推进，清洁能源领域竞争日趋白热化，光伏市场承压加剧，如何构建差异化竞争优势已成为行业关键课题。\n\n2024年，中国清洁能源发电占比达到近1/ 3，但清洁能源内部竞争激烈，形成了风能、水能、核能、氢能融合的多元化竞争格局。其中，风能、水能作为发展成熟的新能源，是光伏一直以来强劲的竞争对手。近年来，以氢能、核能为代表的新能源崛起，又为光伏的发展带来新的挑战。多元化能源竞争格局使得光伏面临进一步转型升级重压。\n\n光伏在国际社会同样面临此等困境。如绿氢在中东正获得越来越多关注，沙特的“2030愿景”和阿联酋的“国家氢能战略”等，都强调了氢能的独特贡献。当全球都开始将目光投向更广阔的新能源领域时，光伏如何保持强有力的竞争成为亟待解决的难题。",
                        image: ""
                    }
                }
            ];

            // 获取DOM元素
            const navIcons = document.querySelectorAll('.nav-icon');
            const titleElement = document.querySelector('.title');
            const difficultyElement = document.querySelector('.difficulty');
            const weaponIconElement = document.querySelector('.weapon-icon i');
            const weaponTooltipElement = document.querySelector('.weapon-tooltip');
            const contentTextElement = document.querySelector('.content-text');
            const upArrow = document.querySelector('.nav-arrow.up');
            const downArrow = document.querySelector('.nav-arrow.down');

            // 当前激活的卡片索引
            let currentIndex = 0;
            // 总卡片数量
            const totalCards = cards.length;

            // ===== 状态条更新函数 =====
            function updateStatusBars(index) {
                // 计算当前进度（0到1之间）
                const progress = Math.min(index / (totalCards - 1), 1);

                // 计算每个状态条的当前宽度
                const healthWidth = originalWidths.health - (originalWidths.health - targetWidth) * progress;
                const energyWidth = originalWidths.energy - (originalWidths.energy - targetWidth) * progress;
                const reputationWidth = originalWidths.reputation - (originalWidths.reputation - targetWidth) * progress;

                // 应用宽度
                healthFill.style.width = `${healthWidth}%`;
                energyFill.style.width = `${energyWidth}%`;
                reputationFill.style.width = `${reputationWidth}%`;
            }

            // ===== 卡片更新函数 =====
            function updateCard(index) {
                const card = cards[index];

                // 更新导航图标状态
                navIcons.forEach((icon, i) => {
                    if (i === index) {
                        icon.classList.add('active');
                    } else {
                        icon.classList.remove('active');
                    }
                });

                // 更新标题
                titleElement.innerHTML = card.title;

                // 更新难度星级
                difficultyElement.innerHTML = '';
                const difficultyLabel = document.createElement('span');
                difficultyLabel.className = 'difficulty-label';
                difficultyLabel.textContent = '难度系数：';
                difficultyElement.appendChild(difficultyLabel);

                for (let i = 0; i < 5; i++) {
                    const star = document.createElement('span');
                    star.className = 'star';
                    star.textContent = i < card.difficulty ? '★' : '☆';
                    difficultyElement.appendChild(star);
                }

                // 更新武器图标和提示
                weaponIconElement.className = card.weaponIcon;
                weaponTooltipElement.textContent = card.weaponTooltip;

                // 清空内容区域
                contentTextElement.innerHTML = '';

                // 根据内容类型创建不同的布局
                switch (card.content.type) {
                    case "iframe":
                        createIframeContent(card.content);
                        break;
                    case "text-image":
                        createTextImageContent(card.content);
                        break;
                    case "split":
                        createSplitContent(card.content);
                        break;
                    case "image-text":
                        createImageTextContent(card.content);
                        break;
                    case "compete":
                        createTextImageContent(card.content);
                        break;
                }

                // 更新状态条
                updateStatusBars(index);
            }

            // ===== 内容布局创建函数 =====
            function createCompeteContent(content) {
                // 竞争内容布局实现
            }

            function createIframeContent(content) {
                const container = document.createElement('div');
                container.className = 'iframe-container';

                // 创建iframe
                const iframe = document.createElement('iframe');
                iframe.src = content.src;
                iframe.className = 'content-iframe';
                iframe.style.height = '400px';
                iframe.style.marginBottom = '20px';

                // 创建下方文本
                const textElement = document.createElement('p');
                textElement.className = 'content-text';
                textElement.innerHTML = content.text.replace(/\n/g, '<br>');

                container.appendChild(iframe);
                container.appendChild(textElement);
                contentTextElement.appendChild(container);
            }

            function createTextImageContent(content) {
                const container = document.createElement('div');
                container.className = 'text-image-container';
                container.style.display = 'flex';
                container.style.flexDirection = 'column';
                container.style.gap = '20px';
                container.style.padding = '20px';

                // 创建文本部分
                const textDiv = document.createElement('div');
                textDiv.className = 'hegemony-text';
                const textContent = content.text || content.left;
                textDiv.innerHTML = `<p class="content-text">${textContent.replace(/\n/g, '<br>')}</p>`;
                container.appendChild(textDiv);

                // 创建图片部分
                if (content.image) {
                    const imageContainer = document.createElement('div');
                    imageContainer.className = 'hegemony-image';
                    const imageElement = document.createElement('img');
                    imageElement.src = content.image;
                    imageElement.style.maxWidth = '100%';
                    imageElement.style.borderRadius = '8px';
                    imageElement.style.objectFit = 'contain';
                    imageContainer.appendChild(imageElement);
                    container.appendChild(imageContainer);
                }

                contentTextElement.appendChild(container);
            }

            function createSplitContent(content) {
                const splitContainer = document.createElement('div');
                splitContainer.className = 'split-layout';
                splitContainer.style.overflow = 'hidden';

                // 左侧文本部分
                const leftDiv = document.createElement('div');
                leftDiv.className = 'split-left';
                leftDiv.innerHTML = `<p class="content-text">${content.left.replace(/\n/g, '<br>')}</p>`;

                // 右侧iframe和备注部分
                const rightDiv = document.createElement('div');
                rightDiv.className = 'split-right';
                rightDiv.style.display = 'flex';
                rightDiv.style.flexDirection = 'column';
                rightDiv.style.gap = '8px';

                // 创建iframe
                const iframe = document.createElement('iframe');
                iframe.className = 'content-iframe';
                iframe.src = content.right;
                iframe.style.minHeight = '400px';
                iframe.style.width = '100%';
                rightDiv.appendChild(iframe);

                // 添加备注信息
                const noteElement = document.createElement('div');
                noteElement.className = 'iframe-note';
                noteElement.style.fontSize = '0.8em';
                noteElement.style.color = '#666';
                noteElement.style.padding = '8px 0';
                noteElement.style.clear = 'both';
                noteElement.style.display = 'block';
                noteElement.textContent = '注：五大指国家能源投资集团、中国华能集团、中国华电集团、中国大唐集团、国家电力投资集团；六小指国投电力、中广核、三峡集团、华润电力、中节能、中核集团';
                rightDiv.appendChild(noteElement);

                splitContainer.appendChild(leftDiv);
                splitContainer.appendChild(rightDiv);
                contentTextElement.appendChild(splitContainer);
            }

            function createImageTextContent(content) {
                const container = document.createElement('div');
                container.className = 'hegemony-content';

                // 创建文本部分
                const textDiv = document.createElement('div');
                textDiv.className = 'hegemony-text';
                textDiv.innerHTML = `<p class="content-text">${content.left.replace(/\n/g, '<br>')}</p>`;

                // 创建图片部分
                const imageDiv = document.createElement('div');
                imageDiv.className = 'hegemony-image';
                const image = document.createElement('img');
                image.src = content.right;
                image.alt = "霸权围剿";

                imageDiv.appendChild(image);
                container.appendChild(textDiv);
                container.appendChild(imageDiv);
                contentTextElement.appendChild(container);
            }

            // ===== 事件监听 =====
            // 导航图标点击事件
            navIcons.forEach((icon, index) => {
                icon.addEventListener('click', () => {
                    currentIndex = index;
                    updateCard(currentIndex);

                    // 平滑滚动到容器顶部
                    const container = document.getElementById('part4-container');
                    if (container) {
                        container.scrollIntoView({
                            behavior: 'smooth',
                            block: 'start'
                        });
                    }

                    // 更新URL哈希
                    const sectionIds = [
                        "misunderstanding",
                        "abandoned-power",
                        "industry",
                        "hegemony",
                        "compete"
                    ];
                    window.location.hash = sectionIds[index];
                });
            });

            // 页面加载时检查哈希
            window.addEventListener('load', () => {
                const sectionIds = [
                    "misunderstanding",
                    "abandoned-power",
                    "industry",
                    "hegemony",
                    "compete"
                ];

                if (window.location.hash) {
                    const hash = window.location.hash.substring(1);
                    const index = sectionIds.indexOf(hash);
                    if (index !== -1) {
                        currentIndex = index;
                        updateCard(currentIndex);

                        // 滚动到容器
                        const container = document.getElementById('part4-container');
                        if (container) {
                            container.scrollIntoView({
                                behavior: 'smooth',
                                block: 'start'
                            });
                        }
                    }
                }
            });

            // 上下箭头点击事件
            upArrow.addEventListener('click', () => {
                currentIndex = (currentIndex - 1 + cards.length) % cards.length;
                updateCard(currentIndex);
            });

            downArrow.addEventListener('click', () => {
                currentIndex = (currentIndex + 1) % cards.length;
                updateCard(currentIndex);
            });

            // 键盘事件
            document.addEventListener('keydown', (e) => {
                if (e.key === 'ArrowUp') {
                    currentIndex = (currentIndex - 1 + cards.length) % cards.length;
                    updateCard(currentIndex);
                } else if (e.key === 'ArrowDown') {
                    currentIndex = (currentIndex + 1) % cards.length;
                    updateCard(currentIndex);
                }
            });

            // 初始化第一个卡片和状态条
            updateCard(0);
        });



        // 创建粒子效果
        function createParticles() {
            const particlesContainer = document.getElementById('particles');
            const particleCount = 50;

            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';

                // 随机位置
                const left = Math.random() * 100;
                const top = Math.random() * 100 + 100; // 从屏幕下方开始

                // 随机大小
                const size = Math.random() * 3 + 1;

                // 随机动画延迟
                const delay = Math.random() * 10;

                // 随机动画持续时间
                const duration = Math.random() * 10 + 5;

                particle.style.left = `${left}%`;
                particle.style.top = `${top}%`;
                particle.style.width = `${size}px`;
                particle.style.height = `${size}px`;
                particle.style.animationDelay = `${delay}s`;
                particle.style.animationDuration = `${duration}s`;

                particlesContainer.appendChild(particle);
            }
        }



        // 背景hover效果
        const loading = {
            container: document.querySelector(".loading"),
            in(target) {
                this.container.classList.remove("loading_out");
                setTimeout(() => {
                    window.location.href = target;
                }, 1000)
            },
            out() {
                this.container.classList.add("loading_out");
            }
        };

        // 页面加载完成后隐藏loading动画
        window.addEventListener("load", () => {
            loading.out();
        });

        // 滚动方向检测
        let lastScrollTop = 0;
        let isScrollingDown = false;

        window.addEventListener('scroll', function () {
            const scrollTop = window.pageYOffset || document.documentElement.scrollTop;

            // 判断滚动方向
            if (scrollTop > lastScrollTop) {
                isScrollingDown = true; // 向下滚动
            } else {
                isScrollingDown = false; // 向上滚动
            }
            lastScrollTop = scrollTop;

            // 检查是否滚动到底部（向下滚动时）
            // if (isScrollingDown && (window.innerHeight + scrollTop) >= document.body.offsetHeight - 50) {
            //     loading.in('./part4Breakthrough.html');
            // }

            // 检查是否滚动到顶部（向上滚动时）
            // if (!isScrollingDown && scrollTop <= 50) {
            //     loading.in('./part2Dawn.html');
            // }
        });




        // 背景网格交互效果
        document.addEventListener('DOMContentLoaded', function () {
            const gridBackground = document.getElementById('gridBackground');
            const cellSize = 40; // 与CSS中保持一致
            let activeCell = null;
            let lastHoveredCell = null;

            // 创建网格
            function createGrid() {
                const cols = Math.ceil(window.innerWidth / cellSize);
                const rows = Math.ceil(window.innerHeight / cellSize);

                for (let row = 0; row < rows; row++) {
                    for (let col = 0; col < cols; col++) {
                        const cell = document.createElement('div');
                        cell.className = 'grid-cell';
                        cell.style.left = `${col * cellSize}px`;
                        cell.style.top = `${row * cellSize}px`;
                        cell.dataset.row = row;
                        cell.dataset.col = col;
                        gridBackground.appendChild(cell);
                    }
                }
            }

            // 激活3x3区域
            function activateArea(row, col) {
                // 如果当前激活的单元格与上次相同，则不执行
                if (lastHoveredCell && lastHoveredCell.dataset.row == row && lastHoveredCell.dataset.col == col) {
                    return;
                }

                // 清除所有激活状态
                document.querySelectorAll('.grid-cell.active').forEach(cell => {
                    cell.classList.remove('active');
                });

                // 随机激活3x3区域内的部分单元格
                for (let r = Math.max(0, row - 1); r <= Math.min(row + 1, Math.ceil(window.innerHeight / cellSize) - 1); r++) {
                    for (let c = Math.max(0, col - 1); c <= Math.min(col + 1, Math.ceil(window.innerWidth / cellSize) - 1); c++) {
                        // 随机决定是否激活该单元格
                        if (Math.random() > 0.5) {
                            const cell = document.querySelector(`.grid-cell[data-row="${r}"][data-col="${c}"]`);
                            if (cell) {
                                cell.classList.add('active');
                            }
                        }
                    }
                }

                // 记录当前激活的单元格
                lastHoveredCell = document.querySelector(`.grid-cell[data-row="${row}"][data-col="${col}"]`);
            }

            // 鼠标移动事件处理
            function handleMouseMove(e) {
                const x = e.clientX;
                const y = e.clientY;

                // 计算当前所在的单元格
                const col = Math.floor(x / cellSize);
                const row = Math.floor(y / cellSize);

                // 激活3x3区域
                activateArea(row, col);
            }

            // 初始化网格
            createGrid();

            // 监听鼠标移动事件
            document.addEventListener('mousemove', handleMouseMove);

            // 窗口大小改变时重新创建网格
            window.addEventListener('resize', function () {
                while (gridBackground.firstChild) {
                    gridBackground.removeChild(gridBackground.firstChild);
                }
                createGrid();
            });
        });
    </script>
</body>

</html>